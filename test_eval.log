INFO - 06/18/21 08:00:25 - 0:00:00 - ============ Initialized logger ============
INFO - 06/18/21 08:00:25 - 0:00:00 - accumulate_gradients: 1
                                     ae_steps: ['cpp_sa', 'llvm_sa']
                                     amp: 2
                                     attention_dropout: 0.0
                                     batch_size: 32
                                     beam_size: 1
                                     bptt: 256
                                     bt_sample_temperature: 0
                                     bt_src_langs: ['llvm_sa', 'cpp_sa']
                                     bt_steps: [('llvm_sa', 'cpp_sa', 'llvm_sa'), ('cpp_sa', 'llvm_sa', 'cpp_sa')]
                                     clip_grad_norm: 5.0
                                     clm_steps: []
                                     command: python XLM/train.py --n_heads 8 --bt_steps 'llvm_sa-cpp_sa-llvm_sa,cpp_sa-llvm_sa-cpp_sa' --max_vocab '-1' --word_mask_keep_rand '0.8,0.1,0.1' --gen_tpb_multiplier 1 --word_blank '0.1' --n_layers 6 --save_periodic 1 --dump_path '/home/carl/TransCoder/output' --max_len 512 --bptt 256 --lambda_clm 1 --ae_steps 'cpp_sa,llvm_sa' --fp16 true --share_inout_emb true --lambda_mlm 1 --sinusoidal_embeddings false --mlm_steps '' --word_shuffle 3 --tokens_per_batch 3000 --has_sentences_ids true --attention_dropout 0 --split_data false --length_penalty 1 --max_epoch 200 --stopping_criterion '' --lambda_bt 1 --generate_hypothesis true --lambda_mt 1 --epoch_size 20000 --data_path '/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml' --gelu_activation false --split_data_accross_gpu global --optimizer 'adam_inverse_sqrt,warmup_updates=10000,lr=0.0001,weight_decay=0.01' --eval_computation true --validation_metrics '' --eval_bleu true --dropout '0.1' --mt_steps '' --reload_emb '' --batch_size 32 --context_size 0 --word_dropout '0.1' --reload_model '/home/carl/TransCoder/output/mlm_cpp_llvm/0000/best-valid_mlm_ppl.pth,/home/carl/TransCoder/output/mlm_cpp_llvm/0000/best-valid_mlm_ppl.pth' --min_count 0 --eval_bleu_test_only false --group_by_size true --early_stopping false --sample_alpha 0 --word_pred '0.15' --amp 2 --max_batch_size 128 --clip_grad_norm 5 --emb_dim 1024 --encoder_only false --lgs 'cpp_sa-llvm_sa' --clm_steps '' --exp_name bt_sa --beam_size 1 --lambda_ae '0:1,100000:0.1,300000:0' --lg_sampling_factor '-1' --eval_only false --exp_id "v22xe5jmh9"
                                     context_size: 0
                                     data_path: /home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml
                                     debug: False
                                     debug_slurm: False
                                     debug_train: False
                                     dropout: 0.1
                                     dump_path: /home/carl/TransCoder/output/bt_sa/v22xe5jmh9
                                     early_stopping: False
                                     emb_dim: 1024
                                     emb_dim_decoder: 1024
                                     emb_dim_encoder: 1024
                                     encoder_only: False
                                     epoch_size: 20000
                                     eval_bleu: True
                                     eval_bleu_test_only: False
                                     eval_computation: True
                                     eval_only: False
                                     eval_temperature: None
                                     exp_id: v22xe5jmh9
                                     exp_name: bt_sa
                                     fp16: True
                                     gelu_activation: False
                                     gen_tpb_multiplier: 1
                                     generate_hypothesis: True
                                     global_rank: 0
                                     group_by_size: True
                                     has_sentences_ids: True
                                     id2lang: {0: 'cpp_sa', 1: 'llvm_sa'}
                                     is_master: True
                                     is_slurm_job: False
                                     lambda_ae: 0:1,100000:0.1,300000:0
                                     lambda_bt: 1
                                     lambda_clm: 1
                                     lambda_mlm: 1
                                     lambda_mt: 1
                                     lang2id: {'cpp_sa': 0, 'llvm_sa': 1}
                                     langs: ['cpp_sa', 'llvm_sa']
                                     length_penalty: 1.0
                                     lg_sampling_factor: -1.0
                                     lgs: cpp_sa-llvm_sa
                                     local_rank: 0
                                     master_port: -1
                                     max_batch_size: 128
                                     max_epoch: 200
                                     max_len: 512
                                     max_vocab: -1
                                     min_count: 0
                                     mlm_steps: []
                                     mono_dataset: {'cpp_sa': {'train': '/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/train.cpp_sa.pth', 'valid': '/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/valid.cpp_sa.pth', 'test': '/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/test.cpp_sa.pth'}, 'llvm_sa': {'train': '/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/train.llvm_sa.pth', 'valid': '/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/valid.llvm_sa.pth', 'test': '/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/test.llvm_sa.pth'}}
                                     mt_steps: []
                                     multi_gpu: False
                                     multi_node: False
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_langs: 2
                                     n_layers: 6
                                     n_layers_decoder: 6
                                     n_layers_encoder: 6
                                     n_nodes: 1
                                     n_share_dec: 0
                                     node_id: 0
                                     number_samples: 1
                                     optimizer: adam_inverse_sqrt,warmup_updates=10000,lr=0.0001,weight_decay=0.01
                                     para_dataset: {('cpp_sa', 'llvm_sa'): {'valid': ('/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/valid.cpp_sa-llvm_sa.cpp_sa.pth', '/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/valid.cpp_sa-llvm_sa.llvm_sa.pth'), 'test': ('/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/test.cpp_sa-llvm_sa.cpp_sa.pth', '/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/test.cpp_sa-llvm_sa.llvm_sa.pth')}}
                                     reload_checkpoint: 
                                     reload_emb: 
                                     reload_model: /home/carl/TransCoder/output/mlm_cpp_llvm/0000/best-valid_mlm_ppl.pth,/home/carl/TransCoder/output/mlm_cpp_llvm/0000/best-valid_mlm_ppl.pth
                                     retry_mistmatching_types: False
                                     sample_alpha: 0.0
                                     save_periodic: 1
                                     separate_decoders: False
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     split_data: False
                                     split_data_accross_gpu: global
                                     stopping_criterion: 
                                     tokens_per_batch: 3000
                                     use_lang_emb: True
                                     validation_metrics: 
                                     word_blank: 0.1
                                     word_dropout: 0.1
                                     word_keep: 0.1
                                     word_mask: 0.8
                                     word_mask_keep_rand: 0.8,0.1,0.1
                                     word_pred: 0.15
                                     word_rand: 0.1
                                     word_shuffle: 3.0
                                     world_size: 1
INFO - 06/18/21 08:00:25 - 0:00:00 - The experiment will be stored in /home/carl/TransCoder/output/bt_sa/v22xe5jmh9
                                     
INFO - 06/18/21 08:00:25 - 0:00:00 - Running command: python XLM/train.py --n_heads 8 --bt_steps 'llvm_sa-cpp_sa-llvm_sa,cpp_sa-llvm_sa-cpp_sa' --max_vocab '-1' --word_mask_keep_rand '0.8,0.1,0.1' --gen_tpb_multiplier 1 --word_blank '0.1' --n_layers 6 --save_periodic 1 --dump_path '/home/carl/TransCoder/output' --max_len 512 --bptt 256 --lambda_clm 1 --ae_steps 'cpp_sa,llvm_sa' --fp16 true --share_inout_emb true --lambda_mlm 1 --sinusoidal_embeddings false --mlm_steps '' --word_shuffle 3 --tokens_per_batch 3000 --has_sentences_ids true --attention_dropout 0 --split_data false --length_penalty 1 --max_epoch 200 --stopping_criterion '' --lambda_bt 1 --generate_hypothesis true --lambda_mt 1 --epoch_size 20000 --data_path '/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml' --gelu_activation false --split_data_accross_gpu global --optimizer 'adam_inverse_sqrt,warmup_updates=10000,lr=0.0001,weight_decay=0.01' --eval_computation true --validation_metrics '' --eval_bleu true --dropout '0.1' --mt_steps '' --reload_emb '' --batch_size 32 --context_size 0 --word_dropout '0.1' --reload_model '/home/carl/TransCoder/output/mlm_cpp_llvm/0000/best-valid_mlm_ppl.pth,/home/carl/TransCoder/output/mlm_cpp_llvm/0000/best-valid_mlm_ppl.pth' --min_count 0 --eval_bleu_test_only false --group_by_size true --early_stopping false --sample_alpha 0 --word_pred '0.15' --amp 2 --max_batch_size 128 --clip_grad_norm 5 --emb_dim 1024 --encoder_only false --lgs 'cpp_sa-llvm_sa' --clm_steps '' --exp_name bt_sa --beam_size 1 --lambda_ae '0:1,100000:0.1,300000:0' --lg_sampling_factor '-1' --eval_only false

WARNING - 06/18/21 08:00:25 - 0:00:00 - Signal handler installed.
INFO - 06/18/21 08:00:25 - 0:00:00 - ============ Monolingual data (cpp_sa)
INFO - 06/18/21 08:00:25 - 0:00:00 - Loading data from /home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/train.cpp_sa.pth ...
INFO - 06/18/21 08:00:25 - 0:00:00 - 49423583 words (49077 unique) in 14111 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
INFO - 06/18/21 08:00:27 - 0:00:01 - Removed 0 empty sentences.
INFO - 06/18/21 08:00:27 - 0:00:01 - Removed 0 empty sentences.
INFO - 06/18/21 08:00:27 - 0:00:01 - Removed 9719 too long sentences.

INFO - 06/18/21 08:00:27 - 0:00:01 - Loading data from /home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/valid.cpp_sa.pth ...
INFO - 06/18/21 08:00:27 - 0:00:01 - 17301334 words (49077 unique) in 4746 sentences. 14 unknown words (6 unique) covering 0.00% of the data.
INFO - 06/18/21 08:00:27 - 0:00:01 - Removed 0 empty sentences.

INFO - 06/18/21 08:00:27 - 0:00:01 - Loading data from /home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/test.cpp_sa.pth ...
INFO - 06/18/21 08:00:27 - 0:00:02 - 16990018 words (49077 unique) in 4755 sentences. 15 unknown words (7 unique) covering 0.00% of the data.
INFO - 06/18/21 08:00:27 - 0:00:02 - Removed 0 empty sentences.

INFO - 06/18/21 08:00:27 - 0:00:02 - ============ Monolingual data (llvm_sa)
INFO - 06/18/21 08:00:27 - 0:00:02 - Loading data from /home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/train.llvm_sa.pth ...
INFO - 06/18/21 08:00:27 - 0:00:02 - 229965061 words (49077 unique) in 158111 sentences. 0 unknown words (0 unique) covering 0.00% of the data.
type(params)<class 'argparse.Namespace'>
langs = ['cpp_sa', 'llvm_sa']
id2lang = {0: 'cpp_sa', 1: 'llvm_sa'}
clm_steps = []
mlm_steps = []
SLURM job: False
0 - Number of nodes: 1
0 - Node ID        : 0
0 - Local rank     : 0
0 - Global rank    : 0
0 - World size     : 1
0 - GPUs per node  : 1
0 - Master         : True
0 - Multi-node     : False
0 - Multi-GPU      : False
0 - Hostname       : beast
path/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/train.cpp_sa.pth
path/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/valid.cpp_sa.pth
path/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/test.cpp_sa.pth
path/home/carl/TransCoder/data/proper_eval2/cpp-llvm-.XLM-syml/train.llvm_sa.pth
Traceback (most recent call last):
  File "XLM/train.py", line 340, in <module>
    main(params)
  File "XLM/train.py", line 244, in main
    data = load_data(params)
  File "/mnt/sabrent/carl/TransCoder/XLM/src/data/loader.py", line 356, in load_data
    load_mono_data(params, data)
  File "/mnt/sabrent/carl/TransCoder/XLM/src/data/loader.py", line 152, in load_mono_data
    dataset = Dataset(
  File "/mnt/sabrent/carl/TransCoder/XLM/src/data/dataset.py", line 101, in __init__
    assert len(self.pos) == (self.sent == self.eos_index).sum()
KeyboardInterrupt
